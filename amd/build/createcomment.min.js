function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("format_timeline/createcomment",["jquery","core/ajax","format_timeline/sweetalert"],function(a,b,c){var d=function(){this.registerEventListeners()};d.prototype.registerEventListeners=function(){a(".post-comment-input").keypress(function(b){var c=b.keyCode?b.keyCode:b.which;if(13===c){b.preventDefault();var d=a(b.currentTarget);this.saveComment(d,d.html())}}.bind(this));a(".post-comment-btn").click(function(b){var c=a(b.currentTarget).closest(".input-group").children(".post-comment-input");this.saveComment(c,c.html())}.bind(this))};d.prototype.saveComment=function(a,c){if(""===c){return}var d=a.closest(".discuss");a.empty();if(0===d.length||1<d.length){this.showToast("error","Error trying to find the discussion for this comment.");return}var e=d.data("id"),f=d.data("courseid");if(_typeof(e)===void 0||_typeof(f)===void 0){this.showInvalidDiscussNotification()}var g=b.call([{methodname:"format_timeline_createcomment",args:{post:{courseid:f,message:c,parent:e}}}]);g[0].done(function(a){this.addCommentToDiscuss(d,a.message)}.bind(this)).fail(function(a){var b=a.message;if(!b){b=a.error}this.showToast("error",b)}.bind(this))};d.prototype.showToast=function(a,b){var d=c.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:8e3,timerProgressBar:!0,onOpen:function onOpen(a){a.addEventListener("mouseenter",c.stopTimer);a.addEventListener("mouseleave",c.resumeTimer)}});d.fire({icon:a,title:b})};d.prototype.addCommentToDiscuss=function(b,c){var d=b.find(".add-comment .userimg").clone(),e=d.attr("alt"),f=b.find(".loadmore"),g=a("<div class='post fadeIn'><div class='userimg'>"+a("<div/>").append(d).html()+"</div><div class='entry'><div class='entry-content'><p class='name'>"+e+"</p><p class='text'>"+c+"</p></div></div></div>");if(0<f.length){g.insertBefore(f)}else{g.insertBefore(b.find(".add-comment"))}};return{init:function init(){return new d}}});
//# sourceMappingURL=createcomment.min.js.map
